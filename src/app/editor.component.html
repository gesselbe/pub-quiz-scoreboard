<div class="background-image"></div>
<div class="table-wrapper">
  <div class="button-bar">
    <div class="button" (click)="onAddTeam()">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48"><path d="M23.7 23.7q1.3-1.6 1.925-3.3.625-1.7.625-3.95t-.625-3.95Q25 10.8 23.7 9.2q3.8-.85 6.675 1.15t2.875 6.1q0 4.1-2.875 6.1T23.7 23.7ZM34.5 40v-4.7q0-2.55-1.3-4.75t-4.5-3.7q8.65 1.1 11.825 3.2 3.175 2.1 3.175 5.25V40ZM40 25.55v-5h-5v-3h5v-5h3v5h5v3h-5v5Zm-24.25-1.6q-3.3 0-5.4-2.1-2.1-2.1-2.1-5.4 0-3.3 2.1-5.4 2.1-2.1 5.4-2.1 3.3 0 5.4 2.1 2.1 2.1 2.1 5.4 0 3.3-2.1 5.4-2.1 2.1-5.4 2.1ZM0 40v-4.7q0-1.75.925-3.175Q1.85 30.7 3.4 30q3.6-1.6 6.425-2.3 2.825-.7 5.925-.7 3.1 0 5.9.7 2.8.7 6.4 2.3 1.55.7 2.5 2.125t.95 3.175V40Zm15.75-19.05q1.95 0 3.225-1.275Q20.25 18.4 20.25 16.45q0-1.95-1.275-3.225Q17.7 11.95 15.75 11.95q-1.95 0-3.225 1.275Q11.25 14.5 11.25 16.45q0 1.95 1.275 3.225Q13.8 20.95 15.75 20.95ZM3 37h25.5v-1.7q0-.8-.4-1.5t-1.25-1.1Q23.4 31.1 21 30.55 18.6 30 15.75 30t-5.225.55Q8.15 31.1 4.6 32.7q-.75.35-1.175 1.075Q3 34.5 3 35.3Zm12.75-20.55Zm0 20.55Z"/></svg>
      Team
    </div>
    <div class="button" (click)="onAddCategory()">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48"><path d="M39 34v-6h-6v-3h6v-6h3v6h6v3h-6v6ZM6 28V8h36v7h-3v-4H9v14h20v3Zm3-7V11v14-4Z"/></svg>
      Category
    </div>
    <div style="flex: 1"></div>
    <div class="button" (click)="onResetBoard()">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48"><path d="M18.05 33.05 24 27l6 6.05 2.35-2.4-5.95-6.05 5.95-6.05-2.35-2.4-6 6.05-5.95-6.05-2.4 2.4 6 6.05-6 6.05Zm-5 8.95q-1.2 0-2.1-.9-.9-.9-.9-2.1V10.5H8v-3h9.4V6h13.2v1.5H40v3h-2.05V39q0 1.2-.9 2.1-.9.9-2.1.9Zm21.9-31.5h-21.9V39h21.9Zm-21.9 0V39Z"/></svg>
      Clear All
    </div>
    <div style="flex: 1"></div>
    <div class="button" (click)="onClosePopup()" [style.visibility]="scoreWindow ? 'visible' : 'hidden'">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48"><path d="m16.5 33.6 7.5-7.5 7.5 7.5 2.1-2.1-7.5-7.5 7.5-7.5-2.1-2.1-7.5 7.5-7.5-7.5-2.1 2.1 7.5 7.5-7.5 7.5ZM24 44q-4.1 0-7.75-1.575-3.65-1.575-6.375-4.3-2.725-2.725-4.3-6.375Q4 28.1 4 24q0-4.15 1.575-7.8 1.575-3.65 4.3-6.35 2.725-2.7 6.375-4.275Q19.9 4 24 4q4.15 0 7.8 1.575 3.65 1.575 6.35 4.275 2.7 2.7 4.275 6.35Q44 19.85 44 24q0 4.1-1.575 7.75-1.575 3.65-4.275 6.375t-6.35 4.3Q28.15 44 24 44Zm0-3q7.1 0 12.05-4.975Q41 31.05 41 24q0-7.1-4.95-12.05Q31.1 7 24 7q-7.05 0-12.025 4.95Q7 16.9 7 24q0 7.05 4.975 12.025Q16.95 41 24 41Zm0-17Z"/></svg>
      Close Popup
    </div>
    <div class="button" (click)="!allowLaunchAnimation ? onLaunch() : onLaunchAnimation()">
      <svg *ngIf="allowLaunchAnimation" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48"><path d="m9.35 20.45 5.3 2.25q.9-1.8 1.925-3.55Q17.6 17.4 18.75 15.8L14.8 15Zm7.7 4.05 6.65 6.65q2.85-1.3 5.35-2.95 2.5-1.65 4.05-3.2 4.05-4.05 5.95-8.3 1.9-4.25 2.05-9.6-5.35.15-9.6 2.05t-8.3 5.95q-1.55 1.55-3.2 4.05-1.65 2.5-2.95 5.35Zm11.45-4.8q-1-1-1-2.475t1-2.475q1-1 2.475-1t2.475 1q1 1 1 2.475t-1 2.475q-1 1-2.475 1t-2.475-1Zm-.75 19.15 5.45-5.45-.8-3.95q-1.6 1.15-3.35 2.175T25.5 33.55Zm16.3-34.7q.45 6.8-1.7 12.4-2.15 5.6-7.1 10.55l-.1.1-.1.1 1.1 5.5q.15.75-.075 1.45-.225.7-.775 1.25l-8.55 8.6-4.25-9.9-8.5-8.5-9.9-4.25 8.6-8.55q.55-.55 1.25-.775.7-.225 1.45-.075l5.5 1.1q.05-.05.1-.075.05-.025.1-.075 4.95-4.95 10.55-7.125 5.6-2.175 12.4-1.725Zm-36.6 27.6Q9.2 30 11.725 29.975 14.25 29.95 16 31.7q1.75 1.75 1.725 4.275Q17.7 38.5 15.95 40.25q-1.3 1.3-4.025 2.15Q9.2 43.25 3.75 44q.75-5.45 1.575-8.2.825-2.75 2.125-4.05Zm2.1 2.15q-.7.75-1.25 2.35t-.95 4.1q2.5-.4 4.1-.95 1.6-.55 2.35-1.25.95-.85.975-2.125.025-1.275-.875-2.225-.95-.9-2.225-.875-1.275.025-2.125.975Z"/></svg>
      <svg *ngIf="!allowLaunchAnimation" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48"><path d="M9 42q-1.2 0-2.1-.9Q6 40.2 6 39V9q0-1.2.9-2.1Q7.8 6 9 6h13.95v3H9v30h30V25.05h3V39q0 1.2-.9 2.1-.9.9-2.1.9Zm10.1-10.95L17 28.9 36.9 9H25.95V6H42v16.05h-3v-10.9Z"/></svg>
      {{ !allowLaunchAnimation ? 'Open Popup' : 'Update Scores'}}
    </div>
    <div class="button fireworks-button" (click)="onRunFireworks()" [style.visibility]="scoreWindow ? 'visible' : 'hidden'">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48"><path d="m4 44 9.3-26 16.85 16.65Zm5.05-5.05 15.7-5.6-10.15-10.2Zm18.8-13.2-1.7-1.7 12-12q1.6-1.6 4.05-1.625Q44.65 10.4 46.25 12l.85.85-1.7 1.7-.95-.95q-.95-.95-2.2-.975Q41 12.6 40 13.6ZM19.9 18l-1.7-1.7 1.5-1.5q1.15-1.15 1.075-2.625Q20.7 10.7 19.7 9.7l-1.4-1.4L20 6.6l1.3 1.3q1.75 1.75 1.725 4.375Q23 14.9 21.25 16.65Zm4.05 3.85-1.7-1.7 7.6-7.6q.95-.95.925-2.425Q30.75 8.65 29.8 7.7l-3.05-3.05 1.7-1.7L31.6 6.1q1.55 1.6 1.6 4.025.05 2.425-1.55 4.025Zm7.9 7.95-1.7-1.7 2.35-2.35q1.75-1.75 4.2-1.8 2.45-.05 4.2 1.7l2.55 2.55-1.7 1.7-2.6-2.6q-1.15-1.15-2.4-1.15t-2.4 1.15Zm-22.8 9.15Z"/></svg>
    </div>
  </div>
  <div class="scrollabe-container">
    <div class="table" [style.--table-columns]="board.teams.length + 1" [style.--table-rows]="board.categories.length + 2">
      <div class="cell header category-column"></div>
      <div class="cell header" *ngFor="let team of board.teams; let teamIndex=index; trackBy: trackByName">
        <input [value]="team.name" [title]="team.name" onfocus="this.select()" (change)="onTeamNameChanged($event, team)"/>
        <svg xmlns="http://www.w3.org/2000/svg" (click)="onDeleteTeam(teamIndex)" viewBox="0 0 48 48"><path d="m16.8 33.3 7.2-7.2 7.2 7.2 2.1-2.1-7.2-7.2 7.2-7.2-2.1-2.1-7.2 7.2-7.2-7.2-2.1 2.1 7.2 7.2-7.2 7.2ZM9 42q-1.2 0-2.1-.9Q6 40.2 6 39V9q0-1.2.9-2.1Q7.8 6 9 6h30q1.2 0 2.1.9.9.9.9 2.1v30q0 1.2-.9 2.1-.9.9-2.1.9Zm0-3h30V9H9v30ZM9 9v30V9Z"/></svg>
      </div>

      <ng-container *ngFor="let category of board.categories;let i=index; trackBy: trackByName">
        <div class="cell category-column">
          <input [id]="'categoryId'+i" [value]="category.name" [title]="category.name" onfocus="this.select()" (change)="onCategoryNameChanged($event, category)"/>
          <svg xmlns="http://www.w3.org/2000/svg" (click)="onDeleteCategory(i)" viewBox="0 0 48 48"><path d="m16.8 33.3 7.2-7.2 7.2 7.2 2.1-2.1-7.2-7.2 7.2-7.2-2.1-2.1-7.2 7.2-7.2-7.2-2.1 2.1 7.2 7.2-7.2 7.2ZM9 42q-1.2 0-2.1-.9Q6 40.2 6 39V9q0-1.2.9-2.1Q7.8 6 9 6h30q1.2 0 2.1.9.9.9.9 2.1v30q0 1.2-.9 2.1-.9.9-2.1.9Zm0-3h30V9H9v30ZM9 9v30V9Z"/></svg>
        </div>
        <div class="cell" *ngFor="let team of board.teams; trackBy: trackByName"
            [class.darker-row]="i%2"
            [class.lighter-row]="(i+1)%2"
            [class.low-score]="team.scores[i] === category.lowScore"
            [class.high-score]="team.scores[i] === category.highScore">
          <input [value]="team.scores[i]" type="number" onfocus="this.select()" (change)="onScoreChanged($event, team, i)"/>
        </div>
      </ng-container>
      <div class="cell category-column"><input value="Total" disabled/></div>
      <div class="cell total-score-row" *ngFor="let team of board.teams; trackBy: trackByName" [class.darker-row]="(board.categories.length) % 2">
        <input [value]="team.totalScore" disabled/>
      </div>
    </div>
  </div>
</div>


<div class="overlay" *ngIf="scoreWindow && !allowLaunchAnimation " style="z-index: 1000">
  <div style="border-radius: 0.5em;overflow: hidden">
    <div class="notification">
      <div class="lds-facebook-wrapper">
        <div class="lds-facebook"><div></div><div></div><div></div></div>
      </div>
    </div>
  </div>
</div>

<div class="overlay" *ngIf="dialogAttributes">
  <div style="border-radius: 0.5em;overflow: hidden">
    <div class="dialog">
      <div class="dialog-header">{{dialogAttributes.title}}</div>
      <div class="dialog-body">{{dialogAttributes.message}}</div>
      <div class="dialog-footer">
        <div class="dialog-button" (click)="closeDialog(true)">{{dialogAttributes.okLabel}}</div>
        <div class="dialog-button" (click)="closeDialog(false)">Cancel</div>
      </div>
    </div>
  </div>
</div>

<div class="overlay" *ngIf="(chromeVersion < 104 && chromeVersion !== 0) || (chromeVersion === 0 && !ignoreBrowser) || askForWindowManagement" (click)="onIgnoreBrowser()">
  <div style="border-radius: 0.5em;overflow: hidden">
    <div class="notification">
      <span *ngIf="chromeVersion === 0">Use a Chrome or Edge browser to benefit from all features.</span>
      <span *ngIf="chromeVersion && chromeVersion < 104">Your browser must be updated. Version 104 or later is required.<br/> Go to Settings -> Help -> About Google Chrome and update.</span>
      <span *ngIf="askForWindowManagement">Waiting for permission to show scores on second screen...</span>
    </div>
  </div>
</div>

<div class="intro-overlay" *ngIf="introPlaying" (animationend)="introPlaying = false">
  <div class="intro" (animationend)="$event.stopPropagation()">Pub Quiz</div>
</div>